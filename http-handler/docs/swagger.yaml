definitions:
  models.ChangePasswordRequest:
    properties:
      password:
        type: string
    type: object
  models.CourtRankingResponse:
    properties:
      elo:
        type: integer
      userId:
        type: string
    type: object
  models.DBCourt:
    properties:
      address:
        type: string
      createdAt:
        type: string
      id:
        type: string
      latitude:
        type: number
      longitude:
        type: number
      name:
        type: string
    type: object
  models.Error:
    properties:
      message:
        type: string
    type: object
  models.Field:
    properties:
      elo:
        type: integer
      name:
        type: string
      ranking:
        type: integer
    type: object
  models.HelloWorldResponse:
    properties:
      response:
        type: string
    type: object
  models.JoinMatchRequest:
    properties:
      team:
        type: integer
    type: object
  models.LoginRequest:
    properties:
      password:
        type: string
      username:
        type: string
    type: object
  models.LoginResponse:
    properties:
      token:
        type: string
      userId:
        type: string
    type: object
  models.MailerRequest:
    properties:
      email:
        type: string
    type: object
  models.MatchRequest:
    properties:
      court_id:
        type: string
      date:
        type: string
      nbre_participant:
        type: integer
      sport:
        $ref: '#/definitions/models.Sport'
    type: object
  models.MatchResponse:
    properties:
      created_at:
        type: string
      current_state:
        $ref: '#/definitions/models.MatchState'
      date:
        type: string
      id:
        type: string
      nbre_participant:
        type: integer
      place:
        type: string
      score1:
        type: integer
      score2:
        type: integer
      sport:
        $ref: '#/definitions/models.Sport'
      users:
        items:
          $ref: '#/definitions/models.UserResponse'
        type: array
    type: object
  models.MatchState:
    enum:
    - Termine
    - Manque Score
    - En cours
    - Valide
    - Manque joueur
    type: string
    x-enum-varnames:
    - Termine
    - ManqueScore
    - EnCours
    - Valide
    - ManqueJoueur
  models.MatchVoteStatusResponse:
    properties:
      matchId:
        type: string
      myTeam:
        $ref: '#/definitions/models.TeamVoteStatus'
      opponent:
        $ref: '#/definitions/models.TeamVoteStatus'
      playerTeam:
        type: integer
    type: object
  models.RegisterRequest:
    properties:
      bio:
        type: string
      email:
        type: string
      password:
        type: string
      username:
        type: string
    type: object
  models.ScorePair:
    properties:
      score1:
        type: integer
      score2:
        type: integer
    type: object
  models.Sport:
    enum:
    - basket
    - foot
    - ping-pong
    type: string
    x-enum-varnames:
    - Basket
    - Foot
    - PingPong
  models.TeamVoteStatus:
    properties:
      hasVoted:
        type: boolean
      score:
        $ref: '#/definitions/models.ScorePair'
    type: object
  models.UpdateScoreRequest:
    properties:
      score1:
        type: integer
      score2:
        type: integer
    type: object
  models.UserPatchRequest:
    properties:
      bio:
        description: '@nullable'
        type: string
      currentFieldId:
        description: '@nullable'
        type: string
      email:
        description: '@nullable'
        type: string
      username:
        description: '@nullable'
        type: string
    type: object
  models.UserResponse:
    properties:
      bio:
        description: '@nullable'
        type: string
      createdAt:
        type: string
      currentFieldId:
        type: string
      favoriteCity:
        description: '@nullable'
        type: string
      favoriteField:
        description: '@nullable'
        type: string
      favoriteSport:
        allOf:
        - $ref: '#/definitions/models.Sport'
        description: '@nullable'
      fields:
        items:
          $ref: '#/definitions/models.Field'
        type: array
      nbMatches:
        type: integer
      profilePicture:
        description: '@nullable'
        type: string
      sports:
        items:
          $ref: '#/definitions/models.Sport'
        type: array
      username:
        type: string
      visitedFields:
        type: integer
      winrate:
        description: '@nullable'
        type: integer
    type: object
info:
  contact: {}
paths:
  /:
    get:
      description: Returns the current server time. If the user is not authenticated,
        returns a fixed default time.
      produces:
      - application/json
      responses:
        "200":
          description: Current time in RFC3339 format
          schema:
            type: string
      summary: Get current server time
      tags:
      - testing
  /change-password:
    post:
      consumes:
      - application/json
      description: Allows a connected param to change their password
      parameters:
      - description: New password payload
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/models.ChangePasswordRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Password changed successfully
        "400":
          description: Bad request (invalid JSON)
          schema:
            $ref: '#/definitions/models.Error'
        "401":
          description: Unauthorized (not connected or param not found)
          schema:
            $ref: '#/definitions/models.Error'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/models.Error'
      security:
      - BearerAuth: []
      summary: Change password for authenticated param
      tags:
      - auth
  /court/{id}:
    get:
      description: Retourne les informations d’un terrain (court) en fonction de son
        identifiant passé dans l’URL
      parameters:
      - description: Identifiant du terrain
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Terrain trouvé
          schema:
            $ref: '#/definitions/models.DBCourt'
        "400":
          description: ID manquant ou invalide
          schema:
            $ref: '#/definitions/models.Error'
        "404":
          description: Terrain non trouvé
          schema:
            $ref: '#/definitions/models.Error'
        "500":
          description: Erreur serveur ou base de données
          schema:
            $ref: '#/definitions/models.Error'
      summary: Récupère un terrain par son ID
      tags:
      - terrain
  /court/all:
    get:
      description: Retourne la liste de tous les terrains enregistrés en base de données
      produces:
      - application/json
      responses:
        "200":
          description: Liste des terrains
          schema:
            items:
              $ref: '#/definitions/models.DBCourt'
            type: array
        "500":
          description: Erreur lors de la récupération des terrains
          schema:
            $ref: '#/definitions/models.Error'
      summary: Liste tous les terrains
      tags:
      - terrain
  /forgot-password:
    post:
      consumes:
      - application/json
      description: Generate a new password and send it via email to the param if the
        account exists
      parameters:
      - description: Email of the param
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/models.MailerRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Success even if param does not exist (for security)
        "400":
          description: Bad request (invalid JSON or email format)
          schema:
            $ref: '#/definitions/models.Error'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/models.Error'
      summary: Request password reset
      tags:
      - auth
  /hello_world:
    get:
      description: Returns a greeting with the provided name
      parameters:
      - description: Name to greet
        in: query
        name: name
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/models.HelloWorldResponse'
      summary: Say Hello
      tags:
      - testing
  /join/match/{id}:
    post:
      description: Permet à un utilisateur authentifié de rejoindre un match existant,
        si ce n’est pas déjà fait
      parameters:
      - description: Identifiant du match
        in: path
        name: id
        required: true
        type: string
      - description: Informations pour rejoindre un match (team)
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/models.JoinMatchRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
        "400":
          description: Identifiant manquant
          schema:
            $ref: '#/definitions/models.Error'
        "401":
          description: Utilisateur non autorisé
          schema:
            $ref: '#/definitions/models.Error'
        "404":
          description: Match non trouvé
          schema:
            $ref: '#/definitions/models.Error'
        "409":
          description: Utilisateur déjà inscrit au match
          schema:
            $ref: '#/definitions/models.Error'
        "500":
          description: Erreur lors de l'inscription de l'utilisateur au match
          schema:
            $ref: '#/definitions/models.Error'
      summary: Un utilisateur rejoint un match
      tags:
      - match
  /login:
    post:
      consumes:
      - application/json
      description: Authenticate a user with username and password
      parameters:
      - description: User credentials
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/models.LoginRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/models.LoginResponse'
        "400":
          description: Bad request
          schema:
            $ref: '#/definitions/models.Error'
        "401":
          description: Invalid credentials
          schema:
            $ref: '#/definitions/models.Error'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/models.Error'
      summary: Login a user
      tags:
      - auth
  /match:
    post:
      consumes:
      - application/json
      description: Enregistre un nouveau match en base de données à partir des données
        fournies en JSON
      parameters:
      - description: Objet match à créer
        in: body
        name: match
        required: true
        schema:
          $ref: '#/definitions/models.MatchRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Match créé avec succès
          schema:
            additionalProperties:
              type: string
            type: object
        "400":
          description: Données invalides ou champ ID manquant
          schema:
            $ref: '#/definitions/models.Error'
        "401":
          description: Utilisateur non autorisé
          schema:
            $ref: '#/definitions/models.Error'
        "500":
          description: Erreur lors de la création du match
          schema:
            $ref: '#/definitions/models.Error'
      summary: Crée un nouveau match
      tags:
      - match
  /match/{id}:
    delete:
      description: Supprime un match via son ID
      parameters:
      - description: Identifiant du match à supprimer
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
        "400":
          description: ID manquant
          schema:
            $ref: '#/definitions/models.Error'
        "401":
          description: Utilisateur non autorisé
          schema:
            $ref: '#/definitions/models.Error'
        "500":
          description: Erreur lors de la suppression du match
          schema:
            $ref: '#/definitions/models.Error'
      summary: Supprime un match
      tags:
      - match
    get:
      description: Retourne les informations d’un match en fonction de son identifiant
        passé en paramètre de requête
      parameters:
      - description: Identifiant du match
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Match trouvé
          schema:
            $ref: '#/definitions/models.MatchResponse'
        "400":
          description: ID manquant ou invalide
          schema:
            $ref: '#/definitions/models.Error'
        "401":
          description: Utilisateur non autorisé
          schema:
            $ref: '#/definitions/models.Error'
        "404":
          description: Match non trouvé
          schema:
            $ref: '#/definitions/models.Error'
        "500":
          description: Erreur serveur ou base de données
          schema:
            $ref: '#/definitions/models.Error'
      summary: Récupère un match par son ID
      tags:
      - match
  /match/{id}/finish:
    patch:
      description: Passe un match de l’état "En cours" à "Manque Score" afin de permettre
        la saisie/validation des scores.
      parameters:
      - description: ID du match
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
        "400":
          description: ID manquant, mauvais état, ou utilisateur non inscrit au match
          schema:
            $ref: '#/definitions/models.Error'
        "401":
          description: Utilisateur non autorisé
          schema:
            $ref: '#/definitions/models.Error'
        "404":
          description: Match non trouvé
          schema:
            $ref: '#/definitions/models.Error'
        "500":
          description: Erreur serveur ou base de données
          schema:
            $ref: '#/definitions/models.Error'
      summary: Termine un match (passage à la saisie des scores)
      tags:
      - match
  /match/{id}/score:
    patch:
      consumes:
      - application/json
      description: Met à jour les scores (score1 et score2) d’un match via son ID
      parameters:
      - description: ID du match
        in: path
        name: id
        required: true
        type: string
      - description: Nouveaux scores
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/models.UpdateScoreRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/models.Error'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/models.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/models.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/models.Error'
      summary: Met à jour le score d’un match
      tags:
      - match
  /match/{id}/start:
    patch:
      description: Passe un match de l’état "Valide" à "En cours" et met à jour la
        date de début à maintenant.
      parameters:
      - description: ID du match
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
        "400":
          description: ID manquant, mauvais état, ou utilisateur non inscrit au match
          schema:
            $ref: '#/definitions/models.Error'
        "401":
          description: Utilisateur non autorisé
          schema:
            $ref: '#/definitions/models.Error'
        "404":
          description: Match non trouvé
          schema:
            $ref: '#/definitions/models.Error'
        "500":
          description: Erreur serveur ou base de données
          schema:
            $ref: '#/definitions/models.Error'
      summary: Démarre un match
      tags:
      - match
  /match/{id}/vote-status:
    get:
      description: Renvoie l'équipe du joueur, si son équipe a voté et le score voté
        (nullable), et la même info pour l'équipe adverse. Ne fonctionne que si le
        match est en statut "Termine".
      parameters:
      - description: ID du match
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/models.MatchVoteStatusResponse'
        "400":
          description: ID manquant, mauvais état
          schema:
            $ref: '#/definitions/models.Error'
        "401":
          description: Utilisateur non autorisé
          schema:
            $ref: '#/definitions/models.Error'
        "404":
          description: Match ou utilisateur non trouvé
          schema:
            $ref: '#/definitions/models.Error'
        "500":
          description: Erreur serveur
          schema:
            $ref: '#/definitions/models.Error'
      summary: Statut de vote des scores (par équipe) pour un match terminé
      tags:
      - match
  /match/all:
    get:
      description: Retourne la liste complète de tous les matchs stockés en base
      produces:
      - application/json
      responses:
        "200":
          description: Liste des matchs
          schema:
            items:
              $ref: '#/definitions/models.MatchResponse'
            type: array
        "401":
          description: Utilisateur non autorisé
          schema:
            $ref: '#/definitions/models.Error'
        "500":
          description: Erreur serveur lors de la récupération des matchs
          schema:
            $ref: '#/definitions/models.Error'
      summary: Liste tous les matchs
      tags:
      - match
  /match/court/{courtId}:
    get:
      description: Retourne les matchs associés à un terrain (court) via son ID
      parameters:
      - description: Identifiant du terrain
        in: path
        name: courtId
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/models.MatchResponse'
            type: array
        "400":
          description: ID manquant
          schema:
            $ref: '#/definitions/models.Error'
        "401":
          description: Utilisateur non autorisé
          schema:
            $ref: '#/definitions/models.Error'
        "404":
          description: Aucun match trouvé pour ce terrain
          schema:
            $ref: '#/definitions/models.Error'
        "500":
          description: Erreur interne serveur ou base
          schema:
            $ref: '#/definitions/models.Error'
      summary: Liste des matchs pour un court
      tags:
      - match
  /place:
    post:
      description: Appelle l'API Google Places pour synchroniser les terrains autour
        d'une position donnée (Paris en dur pour l'instant)
      produces:
      - application/json
      responses:
        "201":
          description: Synchro réussie
        "500":
          description: Erreur lors de la synchronisation
          schema:
            $ref: '#/definitions/models.Error'
      summary: Synchronise les terrains depuis l'API Google Places
      tags:
      - google
  /profile_picture/{id}:
    post:
      consumes:
      - multipart/form-data
      description: Uploads a profile picture to an S3 bucket
      parameters:
      - description: Image file to upload
        in: formData
        name: image
        required: true
        type: file
      produces:
      - application/json
      responses:
        "201":
          description: Created
        "400":
          description: Bad request or file not found
          schema:
            $ref: '#/definitions/models.Error'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/models.Error'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/models.Error'
      summary: Upload a profile picture to S3
      tags:
      - upload
  /ranking/court/{id}:
    get:
      description: Retourne la liste des utilisateurs et leur ELO pour un court donné,
        triée par ELO croissant
      parameters:
      - description: Identifiant du court
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/models.CourtRankingResponse'
            type: array
        "400":
          description: ID manquant
          schema:
            $ref: '#/definitions/models.Error'
        "401":
          description: Utilisateur non autorisé
          schema:
            $ref: '#/definitions/models.Error'
        "500":
          description: Erreur serveur / base
          schema:
            $ref: '#/definitions/models.Error'
      summary: Classement ELO par terrain
      tags:
      - ranking
  /ranking/user/{userId}:
    get:
      description: 'Retourne uniquement la liste des fields associés à un utilisateur
        (ex: terrains classés/évalués)'
      parameters:
      - description: Identifiant de l'utilisateur
        in: path
        name: userId
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/models.Field'
            type: array
        "400":
          description: userId manquant
          schema:
            $ref: '#/definitions/models.Error'
        "401":
          description: Utilisateur non autorisé
          schema:
            $ref: '#/definitions/models.Error'
        "500":
          description: Erreur serveur / base
          schema:
            $ref: '#/definitions/models.Error'
      summary: Liste des terrains (fields) d’un utilisateur
      tags:
      - user
  /register:
    post:
      consumes:
      - application/json
      description: Register a user with username and password
      parameters:
      - description: User credentials
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/models.RegisterRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/models.LoginResponse'
        "400":
          description: Bad request
          schema:
            $ref: '#/definitions/models.Error'
        "401":
          description: User already exists
          schema:
            $ref: '#/definitions/models.Error'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/models.Error'
      summary: Register a new user
      tags:
      - auth
  /reset-password/{token}:
    get:
      consumes:
      - application/json
      description: Vérifie le token JWT fourni, génère un nouveau mot de passe, l'envoie
        par email à l'utilisateur et met à jour le mot de passe dans la base de données
      parameters:
      - description: Token JWT de réinitialisation
        in: path
        name: token
        required: true
        type: string
      produces:
      - text/html
      responses:
        "200":
          description: HTML indiquant que le mot de passe a été envoyé (même si l'utilisateur
            n'existe pas pour des raisons de sécurité)
          schema:
            type: string
        "400":
          description: 'Requête invalide (ex: token manquant)'
          schema:
            $ref: '#/definitions/models.Error'
        "500":
          description: Erreur interne du serveur (génération du mot de passe, envoi
            de mail, ou mise à jour en base)
          schema:
            $ref: '#/definitions/models.Error'
      summary: Réinitialise le mot de passe d’un utilisateur via un lien sécurisé
      tags:
      - auth
  /user/matches/{userId}:
    get:
      description: Retourne les matchs auxquels un utilisateur a participé
      parameters:
      - description: Identifiant de l'utilisateur
        in: path
        name: userId
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/models.MatchResponse'
            type: array
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/models.Error'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/models.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/models.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/models.Error'
      summary: Liste des matchs d’un utilisateur
      tags:
      - match
  /users/{id}:
    delete:
      consumes:
      - application/json
      description: Remove a user permanently
      parameters:
      - description: User ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
        "400":
          description: Missing ID in URL params
          schema:
            $ref: '#/definitions/models.Error'
        "403":
          description: Incorrect rights
          schema:
            $ref: '#/definitions/models.Error'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/models.Error'
      security:
      - BearerAuth: []
      summary: Delete a user by ID
      tags:
      - users
    get:
      consumes:
      - application/json
      description: Retrieve user information, including profile picture and preferences
      parameters:
      - description: User ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/models.UserResponse'
        "400":
          description: Missing ID in URL params
          schema:
            $ref: '#/definitions/models.Error'
        "404":
          description: User not found
          schema:
            $ref: '#/definitions/models.Error'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/models.Error'
      security:
      - BearerAuth: []
      summary: Get a user by ID
      tags:
      - users
    patch:
      consumes:
      - application/json
      description: Update user fields
      parameters:
      - description: User ID
        in: path
        name: id
        required: true
        type: string
      - description: User fields to update
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/models.UserPatchRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
        "400":
          description: Missing ID in URL params
          schema:
            $ref: '#/definitions/models.Error'
        "403":
          description: Incorrect rights
          schema:
            $ref: '#/definitions/models.Error'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/models.Error'
      security:
      - BearerAuth: []
      summary: Patch a user by ID
      tags:
      - users
swagger: "2.0"
